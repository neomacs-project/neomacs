<h1>Positions</h1><p>A <i>position</i> denotes somewhere in the DOM tree, which can be before or after some node, or between two adjacent nodes.</p><p>Positions may become invalid after editing operations. To maintain a valid position across arbitrary editing operations, see <a href="markers.html">Markers</a>.</p><h2>Types of positions</h2><ul><li>An <code>element</code> denotes the position before the <code>element</code>.</li><li><code>(end-pos node)</code> denotes the position at the end of  <code>node</code> (after any children).<code>node</code> must be an <code>element</code>.</li><li><code>(text-pos node offset)</code> denotes the position before the <code>offset</code>-th character of <code>node</code>. <code>node</code> must be a <code>text-node</code>.</li><li><code>nil</code> denotes nowhere. Many position-related functions return nil if requested position does not exist, and propagates nil if they receive nil position as an argument.</li></ul><h2>Node around positions</h2><p>The following functions query node around a given position.   The return value can be a <code>character</code> or <code>element</code>.If no node is found, nil is returned.</p><ul><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'node-after</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'node-before</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'node-containing</span></div></span></li></ul><h2>Computing positions</h2><p>Basic position functions:</p><ul><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-left</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-right</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-next</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-prev</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-up</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-down</span></div></span></li><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'pos-down-last</span></div></span></li></ul><p>Iterate until or ensure a position predicate is satisfied: <code>pos-*-until</code>, <code>pos-*-ensure</code></p><p>Destructive variants: <code>npos-*</code></p><p>All of the above functions may take and return nil positions without signaling error.</p><h2>Comparing positions</h2><p>Two positions point to the same location iff they are <code>equalp</code>.</p><p>Additional functions for comparing positions:</p><ul><li><span class="comma-expr"><div class="list"><span class="symbol" operator="">fundoc</span><span class="symbol">'before-p</span></div></span></li></ul>